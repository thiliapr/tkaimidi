# MIDI 处理与线程工具库 · API 文档

---

## `midi_to_notes(midi_file) -> list[tuple[int, int]]`

提取 MIDI 文件中的音符信息及其时间间隔。

| 参数名         | 类型              | 描述              |
| ----------- | --------------- | --------------- |
| `midi_file` | `mido.MidiFile` | 要解析的 MIDI 文件对象。 |

| 返回值 | 类型                      | 描述               |
| --- | ----------------------- | ---------------- |
| -   | `list[tuple[int, int]]` | 每个元组包含音高和相对时间间隔。 |

---

## `notes_to_sheet(notes) -> tuple[list[int], list[int]]`

将音符信息转换为电子乐谱。

| 参数名               | 类型                      | 描述                                                 |
| ----------------- | ----------------------- | -------------------------------------------------- |
| `notes`           | `list[tuple[int, int]]` | 音高和相对时间的音符列表。                                      |

| 返回值         | 类型          | 描述             |
| ----------- | ----------- | -------------- |
| `sheet`     | `list[int]` | 电子乐谱事件列表。      |
| `positions` | `list[int]` | 每个音符在乐谱中的位置索引。 |

---

## `sheet_to_notes(sheet) -> Iterator[tuple[int, int]]`

将电子乐谱转换为音符流。

| 参数名     | 类型              | 描述                                |
| ------- | --------------- | --------------------------------- |
| `sheet` | `Iterator[int]` | 电子乐谱数据流（由 `notes_to_sheet()` 生成）。 |

| 返回值 | 类型                               | 描述                         |
| --- | -------------------------------- | -------------------------- |
| -   | `Iterator[tuple[int, int]]` | `(音高, 时间间隔)` 的生成器。 |

---

## `empty_cache()`

清理 CUDA 显存并进行垃圾回收。

| 参数名   | 类型    | 描述                              |
| ----- | ----- | ------------------------------- |
| *(无)* | *(无)* | 自动检测并清空 CUDA 缓存，执行 Python 垃圾回收。 |
